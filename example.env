# Iptables Rules

# Type of iptables chain to protect
# 0: INPUT only (native servers), 1: DOCKER only (containers), 2: BOTH
TYPECHAIN=0

# Enable/disable TCP protection against RCON spam
# true: Blocks malicious TCP connections to game ports (except whitelisted IPs)
# false: Allows normal TCP connections with basic rate-limiting
ENABLE_TCP_PROTECT=false

# Specific TCP ports to protect (optional when ENABLE_TCP_PROTECT=true)
# Format: "27001:27016" (range) or "27001,27002,27003" (specific)
# Empty: applies TCP protection to all GAMESERVERPORTS
# With value: applies protection only to these specific ports
TCP_PROTECTION=""

# Additional TCP ports for Docker containers (rate-limiting)
# Examples: "80,443" (HTTP/HTTPS), "8080" (HTTP-ALT), "3000:3100" (range)
# Empty: disabled. Only applies when TYPECHAIN includes DOCKER (1 or 2)
TCP_DOCKER=""

# Custom SSH ports for the system
# Format: "22" (standard), "422,4222,4223" (multiple), "2222:2230" (range)
# These ports are always allowed for remote administration
SSH_PORT="422,4222"

# SSH ports for Docker containers (optional)
# Allows SSH access to specific containers. Same format as SSH_PORT
# Empty: disabled. Only applies when TYPECHAIN includes DOCKER (1 or 2)
SSH_DOCKER=""

# Source Engine game server ports (GameServer)
# These ports handle: player connections, A2S queries, Steam communication
# Standard format: "27001:27016" (16 servers), "27015" (single server)
GAMESERVERPORTS="27015"

# SourceTV ports (spectators and streaming)
# Separated from GameServer for better control. Only handle spectator traffic
# Standard format: "27101:27116" (matches GameServer count)
TVSERVERPORTS="27020"

# Server tickrate (determines cmdrate limits)
# Typical tickrates: 60 (casual), 100 - 128 (competitive)
# Used to calculate UDP limits: CMD_LIMIT+10 (burst), CMD_LIMIT+30 (maximum)
CMD_LIMIT=100

# Trusted IPs (complete whitelist)
# These IPs bypass ALL rate-limits and TCP blocks
# Format: "1.2.3.4" (single IP), "1.2.3.4 5.6.7.8" (multiple space-separated)
# Use for: administrators, monitoring servers, absolutely trusted IPs
WHITELISTED_IPS=""

# Detailed log prefixes for specific attack types
# These allow for more granular analysis of different attack patterns
LOG_PREFIX_INVALID_SIZE="INVALID_SIZE: "
LOG_PREFIX_MALFORMED="MALFORMED: "
LOG_PREFIX_A2S_INFO="A2S_INFO_FLOOD: "
LOG_PREFIX_A2S_PLAYERS="A2S_PLAYERS_FLOOD: "
LOG_PREFIX_A2S_RULES="A2S_RULES_FLOOD: "
LOG_PREFIX_STEAM_GROUP="STEAM_GROUP_FLOOD: "
LOG_PREFIX_L4D2_CONNECT="L4D2_CONNECT_FLOOD: "
LOG_PREFIX_L4D2_RESERVE="L4D2_RESERVE_FLOOD: "
LOG_PREFIX_UDP_NEW_LIMIT="UDP_NEW_LIMIT: "
LOG_PREFIX_UDP_EST_LIMIT="UDP_EST_LIMIT: "
LOG_PREFIX_TCP_RCON_BLOCK="TCP_RCON_BLOCK: "
LOG_PREFIX_ICMP_FLOOD="ICMP_FLOOD: "

# ============================================================================

# Log Analysis Configuration

# Path to the iptables log file
# This file contains iptables logs generated by the iptables rules
# Default location where iptables writes blocked packet information
# LOGFILE=/var/log/l4d2-iptables.log
LOGFILE=/var/log/l4d2-iptables.log

# Path to rsyslog configuration file for L4D2 iptables
# This file configures rsyslog to capture iptables logs
# RSYSLOG_CONF=/etc/rsyslog.d/l4d2-iptables.conf
RSYSLOG_CONF=/etc/rsyslog.d/l4d2-iptables.conf

